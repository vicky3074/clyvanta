name: Deploy to Production

on:
  push:
    branches: [ main ]

jobs:
  deploy:
    name: Manual Deploy Instructions
    runs-on: ubuntu-latest
    
    steps:
    - name: Display Deploy Commands
      run: |
        echo "ðŸš€ DEPLOYMENT READY!"
        echo ""
        echo "Run these commands manually to deploy:"
        echo ""
        echo "ssh -i ~/.ssh/clyvanta_deploy_new ubuntu@159.203.61.237 << 'EOF'"
        echo "  # Pull latest code"
        echo "  cd ~ && git clone https://github.com/vicky3074/clyvanta.git temp_repo || (cd temp_repo && git pull)"
        echo "  "
        echo "  # Generate SSL certificates"
        echo "  cd temp_repo && mkdir -p ssl"
        echo "  openssl genrsa -out ssl/key.pem 2048"
        echo "  openssl req -new -x509 -key ssl/key.pem -out ssl/cert.pem -days 365 -subj '/C=CA/ST=Ontario/L=Toronto/O=Clyvanta/CN=clyvanta.com'"
        echo "  "
        echo "  # Stop existing containers"
        echo "  docker stop clyvanta-nginx clyvanta-website clyvanta-postgres || true"
        echo "  docker rm clyvanta-nginx clyvanta-website clyvanta-postgres || true"
        echo "  "
        echo "  # Start new containers"
        echo "  docker-compose up -d --build"
        echo "  "
        echo "  # Cleanup"
        echo "  cd ~ && rm -rf temp_repo"
        echo "EOF"
        echo ""
        echo "âœ… Copy and run the commands above to complete deployment!"